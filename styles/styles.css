:root{
  --bg:#0a0a0a;
  --panel:#0c0c0f;
  --panel-2:#09090b;
  --accent:#ef4444;
  --accent-2:#b91c1c;
  --text:#f3f4f6;
  --muted:#9ca3af;
  --danger:#ef4444;
  --bot:#121217;
  --me:#ef4444;

  --radius:18px;
  --pad:clamp(10px, 1.2vw, 16px);
  --fs:clamp(14px, 1.6vw, 15px);
  --fs-sm:clamp(11.5px, 1.2vw, 12.5px);
  --avatar:clamp(32px, 4vw, 40px);

  --logo-max: 620px;
  --logo-scale: 1.6;
}

:root[data-theme="light"]{
  --bg:#ffffff;
  --panel:#ffffff;
  --panel-2:#ffffff;
  --accent:#dc2626;
  --accent-2:#991b1b;
  --text:#0f172a;
  --muted:#6b7280;
  --danger:#dc2626;
  --bot:#ffffff;
  --me:#fff5f5;
}

*{ box-sizing:border-box }
html,body{ height:100% }

body{
  margin:0;
  background:
    radial-gradient(1200px 800px at 10% -10%, rgba(239,68,68,.08), transparent 60%),
    radial-gradient(900px 700px at 100% 0%, rgba(185,28,28,.10), transparent 55%),
    linear-gradient(180deg, var(--bg), #050505 60%);
  color:var(--text);
  font: var(--fs)/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji";
  display:flex; align-items:center; justify-content:center;
  padding: clamp(10px,2vw,20px);
}

:root[data-theme="light"] body{
  background:
    radial-gradient(900px 600px at 100% 0%, rgba(220,38,38,.05), transparent 60%),
    radial-gradient(900px 600px at 0% 100%, rgba(153,27,27,.04), transparent 60%),
    var(--bg);
}

::selection{ background:rgba(239,68,68,.35); color:#fff }
:root[data-theme="light"] ::selection{ background:rgba(220,38,38,.18); color:#111827 }
::-webkit-scrollbar{ height:10px; width:10px }
::-webkit-scrollbar-thumb{
  background: linear-gradient(#b91c1c,#7f1d1d); border-radius:10px
}
:root[data-theme="light"] ::-webkit-scrollbar-thumb{
  background:linear-gradient(#ef4444,#b91c1c)
}

.card{
  width:min(920px, 95vw);
  height:min(78svh, 700px);
  background: linear-gradient(180deg, var(--panel), var(--panel-2));
  border:1px solid rgba(239,68,68,.12);
  border-radius:var(--radius);
  box-shadow: 0 18px 40px rgba(0,0,0,.6), inset 0 1px 0 rgba(255,255,255,.04);
  display:grid; grid-template-rows:auto auto 1fr auto;
  overflow:hidden;
}

:root[data-theme="light"] .card{
  background: linear-gradient(180deg, var(--panel), var(--panel-2));
  border:1px solid #e5e7eb;
  box-shadow:0 10px 30px rgba(16,24,40,.06);
}

.header{
  display:flex; align-items:center; gap:12px;
  padding:14px 16px; border-bottom:1px solid rgba(239,68,68,.14);
  background: linear-gradient(180deg, #0d0d10e6, #0a0a0de6);
  position:relative;
}
:root[data-theme="light"] .header{
  background:#fffffff2;
  border-bottom:1px solid #e5e7eb;
}

.avatar{
  width:var(--avatar); height:var(--avatar); border-radius:25%;
  background-image: url("../img/botpicture1.png");
  background-size:contain; background-position:center; background-repeat:no-repeat;
  box-shadow:0 0 0 3px #0b0f14cc, 0 0 16px #ef444480, 0 0 32px #ef444440;
  flex:0 0 auto;
}
:root[data-theme="light"] .avatar{
  box-shadow:0 0 0 3px rgba(220,38,38,.18), 0 6px 20px rgba(220,38,38,.12);
}

.title{ font-weight:650; letter-spacing:.2px; font-size:clamp(14px,2vw,16px); color:var(--text) }
.subtitle{ color:var(--muted); font-size:var(--fs-sm) }

.status{
  position:absolute; right:16px; top:14px; color:var(--muted);
  font-size:var(--fs-sm); display:flex; align-items:center; gap:6px;
}
.pulse{
  width:6px; height:6px; border-radius:50%;
  background:var(--accent); box-shadow:0 0 0 0 var(--accent);
  animation:pulse 1.8s infinite;
}
@keyframes pulse{
  0%{box-shadow:0 0 0 0 var(--accent)}
  70%{box-shadow:0 0 0 10px transparent}
  100%{box-shadow:0 0 0 0 transparent}
}

.quick{
  display:grid; gap:8px; padding:10px 12px;
  border-bottom:1px solid rgba(239,68,68,.12);
  background:#060606cc;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
}
.quick button{
  padding:8px 12px; border-radius:10px; border:1px solid rgba(239,68,68,.20);
  background:linear-gradient(180deg,#111114,#0a0a0d);
  color:var(--text); cursor:pointer; font-size:clamp(12px,1.5vw,14px);
  transition:transform .08s ease, box-shadow .12s ease, border-color .12s ease, background .12s ease;
}
.quick button:hover{
  border-color:var(--accent);
  box-shadow:0 0 0 3px rgba(239,68,68,.12) inset, 0 6px 20px rgba(239,68,68,.15);
  transform:translateY(-1px);
}

:root[data-theme="light"] .quick{
  background:#fff;
  border-bottom:1px solid #e5e7eb;
}
:root[data-theme="light"] .quick button{
  background:#fff;
  color:var(--text);
  border:1px solid #e5e7eb;
  box-shadow:none;
}
:root[data-theme="light"] .quick button:hover{
  border-color:var(--accent);
  background:#fff7f7;
  box-shadow:0 6px 20px rgba(220,38,38,.10);
}

.log{
  padding:16px; overflow:auto; display:flex; flex-direction:column; gap:10px;
  background:
    radial-gradient(600px 400px at 100% 100%, rgba(239,68,68,.12), transparent 60%),
    radial-gradient(600px 400px at 0% 0%, rgba(185,28,28,.08), transparent 50%);
}
:root[data-theme="light"] .log{
  background:
    radial-gradient(600px 400px at 100% 100%, rgba(220,38,38,.06), transparent 60%),
    radial-gradient(600px 400px at 0% 0%, rgba(153,27,27,.04), transparent 50%);
}

.msg{
  max-width:78%; padding:10px 12px; border-radius:14px; position:relative;
  backdrop-filter: blur(2px);
  box-shadow:0 6px 18px #0006, inset 0 1px 0 rgba(255,255,255,.04);
  word-wrap:break-word; white-space:pre-wrap;
  font-size:clamp(13px,1.6vw,15px);
}
.bot{ background:linear-gradient(180deg, var(--bot), #0e0e13); border:1px solid rgba(239,68,68,.12) }
.me { background:linear-gradient(180deg, rgba(239,68,68,.25), rgba(185,28,28,.2)); border:1px solid rgba(239,68,68,.45); align-self:flex-end }
:root[data-theme="light"] .bot{
  background:linear-gradient(180deg, #fff, #fbfbfb);
  border:1px solid #e5e7eb;
  box-shadow:0 6px 18px rgba(16,24,40,.06), inset 0 1px 0 rgba(255,255,255,.7);
}
:root[data-theme="light"] .me{
  background:linear-gradient(180deg, #fff, #fff5f5);
  border:1px solid rgba(220,38,38,.35);
}
.msg small{ color:var(--muted); display:block; margin-top:6px; font-size:clamp(10px,1.2vw,11px) }

.typing{ display:inline-flex; gap:6px; align-items:center; }
.dot{ width:6px; height:6px; border-radius:50%; background:#9ca3af88; animation:bounce 1.3s infinite }
.dot:nth-child(2){ animation-delay:.15s } .dot:nth-child(3){ animation-delay:.3s }
@keyframes bounce{ 0%,100%{ transform: translateY(0); opacity:.5 } 50%{ transform: translateY(-4px); opacity:1 } }

.msg-media{
  max-width:100%;
  border-radius:10px;
  display:block;
  margin:8px 0;
}
.msg-link{ margin-top:8px; }
.msg-link a{
  display:inline-flex; align-items:center; gap:6px;
  text-decoration:none;
  color: var(--accent);
  border-bottom: 1px dashed currentColor;
}
.msg-link a:hover{ border-bottom-style: solid; }

.option-group{ display:flex; flex-wrap:wrap; gap:8px; margin-top:8px }
.option-chip{
  padding:8px 12px; border-radius:10px; border:1px solid rgba(239,68,68,.25);
  background:linear-gradient(180deg,#111114,#0a0a0d); color:var(--text); cursor:pointer;
  font-size:clamp(12px,1.5vw,14px);
}
.option-chip:hover{
  border-color:var(--accent);
  box-shadow:0 0 0 3px rgba(239,68,68,.12) inset, 0 6px 20px rgba(239,68,68,.15);
}
.nav-chip{
  padding:6px 10px; border-radius:10px; border:1px dashed rgba(239,68,68,.35);
  background:transparent; color:var(--text); cursor:pointer; font-size:12px;
}
.nav-chip:hover{ border-color:var(--accent) }

:root[data-theme="light"] .option-chip{
  background:#fff; color:var(--text); border:1px solid #e5e7eb; box-shadow:none;
}
:root[data-theme="light"] .option-chip:hover{
  background:#fff7f7; border-color:var(--accent); box-shadow:0 6px 20px rgba(220,38,38,.10);
}
:root[data-theme="light"] .nav-chip{
  background:#fff; color:var(--text); border:1px dashed #e5e7eb;
}
:root[data-theme="light"] .nav-chip:hover{
  border-color:var(--accent); background:#fff7f7;
}

#themeToggleBtn,
#langToggleBtn{
  position:absolute;
  display:inline-flex; align-items:center; justify-content:center;
  width:36px; height:36px; border-radius:12px;
  border:none;
  background:linear-gradient(180deg,#111114,#0a0a0d);
  color:var(--text);
  cursor:pointer;
  padding:0;
  transition: box-shadow .15s ease;
}
#themeToggleBtn:hover,
#langToggleBtn:hover{ box-shadow:0 6px 18px rgba(239,68,68,.18) }

#themeToggleBtn{ right:72px;  top:10px; }
#langToggleBtn { right:120px; top:10px; }

#themeToggleBtn img,
#langToggleBtn img{
  width:20px; height:20px; display:block; object-fit:contain;
}

#langToggleBtn img{ object-fit:cover; border-radius:3px }

:root[data-theme="light"] #themeToggleBtn,
:root[data-theme="light"] #langToggleBtn{
  background:linear-gradient(180deg,#ffffff,#f3f4f6);
  border:none;
}

#preloader{
  position:fixed; inset:0; z-index:9999;
  background:#fff;
  display:grid; place-items:center;
  transition:opacity .5s ease, visibility .5s ease;
}
:root[data-theme="dark"] #preloader{ background:#000 }

.logo-img{
  width: min(70vw, var(--logo-max));
  height: auto;
  filter: drop-shadow(0 0 20px rgba(239,68,68,.25));
  transform-origin:center;
  opacity:0; transform: scale(.9);
  will-change: transform, opacity;
  animation: popIn .9s cubic-bezier(.2,.8,.2,1) .1s forwards;
}
.logo-img.pulse{
  animation: popIn 1s cubic-bezier(.9,.8,.8,1) .5s forwards,
             breathe 2.4s ease-in-out 1s infinite;
}
#preloader.hidden{ opacity:0; visibility:hidden }

@keyframes popIn{
  0%   { transform: scale(.6);  opacity:0; }
  60%  { transform: scale(calc(var(--logo-scale) * 1.25)); opacity:1; }
  100% { transform: scale(var(--logo-scale)); opacity:1; }
}
@keyframes breathe{
  0%,100%{ transform: scale(var(--logo-scale)); }
  50%    { transform: scale(calc(var(--logo-scale) * 1.03)); }
}

#topbar{ position:fixed; top:0; left:0; width:100%; height:4px; z-index:10000; pointer-events:none }
#topbar span{
  display:block; width:0%; height:100%;
  background:linear-gradient(90deg,#7f1d1d,#ef4444,#7f1d1d);
  background-size:200% 100%;
  box-shadow:0 0 10px #ef4444, 0 0 30px #ef444480, 0 0 60px #ef444440;
  animation:shimmer 1.2s linear infinite, glow 1.8s ease-in-out infinite alternate;
  transition:width .5s ease;
}
@keyframes shimmer { from{background-position:0 0} to{background-position:200% 0} }
@keyframes glow { from{box-shadow:0 0 8px #ef4444,0 0 0 #0000} to{box-shadow:0 0 16px #ef4444,0 0 40px #ef444480} }

.error{ color:var(--danger) }
.footnote{ color:var(--muted); font-size:var(--fs-sm); padding:6px 14px 12px }

@media (max-width:820px){
  .card{ height:min(82svh, 720px) }
  .status{ position:static; margin-left:auto }
  #themeToggleBtn{ position:static; margin-left:auto; order:3 }
  #langToggleBtn { position:static; margin-left:8px;  order:4 }
}
@media (max-width:640px){
  body{ padding:8px }
  .card{ width:100%; height:calc(var(--vh, 1svh) * 100); border-radius:14px }
  .header{ padding:10px 12px; gap:10px }
  .subtitle{ display:none }
  .msg{ max-width:100% }
  .quick{ grid-template-columns:1fr 1fr }
}
@media (max-width:400px){
  .quick{ grid-template-columns:1fr }
}
@media (prefers-reduced-motion: reduce){
  *{ animation:none !important; transition:none !important }
  #topbar span{ animation:none !important }
}

/* ===== Mobile ultra (≈ iPhone 12 mini / 378px) ===== */
@media (max-width: 420px){
  .header{
    flex-wrap: wrap;               /* permite 2 filas */
    row-gap: 8px;
  }

  /* La etiqueta de estado ocupa su propia fila */
  .header .status{
    order: 2;
    margin-left: 0;
    flex-basis: 100%;              /* rompe línea */
  }

  /* Controles: Quejas + Tema + Idioma en la 2ª fila, a la derecha */
  #openComplaintsBtn{              /* Quejas */
    order: 3;
    position: static !important;   /* anula el absolute del desktop */
    margin-left: auto;             /* empuja el grupo a la derecha */
    height: 36px;
    padding: 0 12px;
  }

  #themeToggleBtn{                 /* Tema */
    order: 4;
    position: static;
    margin-left: 8px;
    width: 40px; height: 40px;     /* mejor touch target */
  }

  #langToggleBtn{                  /* Idioma */
    order: 5;
    position: static;
    margin-left: 8px;
    width: 40px; height: 40px;     /* mejor touch target */
  }
}
